{"version":3,"sources":["./src/app/reply-modal/reply-modal.page.html","./src/app/reply-modal/reply-modal-routing.module.ts","./src/app/reply-modal/reply-modal.module.ts","./src/app/reply-modal/reply-modal.page.scss","./src/app/reply-modal/reply-modal.page.ts"],"names":[],"mappings":"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","file":"default~product-detail-product-detail-module~reply-modal-reply-modal-module-es2015.js","sourcesContent":["module.exports = \"<ion-header translucent>\\n  <ion-toolbar>\\n    <ion-title *ngIf=\\\"post\\\">Reply {{post.docId}}</ion-title>\\n    <ion-buttons slot=\\\"end\\\">\\n      <ion-button (click)=\\\"dismiss()\\\">Close</ion-button>\\n    </ion-buttons>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n  <ion-card *ngIf=\\\"post\\\">\\n    <ion-img *ngIf=\\\"post.img\\\" [src]=\\\"post.img\\\"></ion-img>\\n    <ion-text>\\n      <p id=\\\"title\\\" *ngIf=\\\"post.title\\\">{{post.title}}</p>\\n      <p id=\\\"text\\\">{{post.text}}</p>\\n      <p id=\\\"timestamp\\\" color=\\\"primary\\\" *ngIf=\\\"post.timestamp\\\">Posted At {{getDate(post.timestamp)}}</p>\\n    </ion-text>\\n</ion-card>\\n\\n\\n  <form [formGroup]=\\\"new_reply_form\\\" (submit)=\\\"createReply(new_reply_form.value)\\\">\\n    <ion-item>\\n      <ion-label position=\\\"stacked\\\">Text</ion-label>\\n      <ion-textarea type=\\\"text\\\" formControlName=\\\"text\\\" required=true></ion-textarea>\\n    </ion-item>\\n\\n    <ion-button class=\\\"submit-btn\\\" expand=\\\"block\\\" (click)=\\\"selectImage()\\\">\\n      Add Image\\n    </ion-button>\\n\\n    <ion-img *ngIf=\\\"imgFile\\\" style=\\\"border-radius: 10px; overflow:hidden;\\\" [src]=\\\"imgFile\\\"></ion-img>\\n\\n    <ion-button class=\\\"submit-btn\\\" expand=\\\"block\\\" type=\\\"submit\\\" disabled={{!new_reply_form.valid}}>\\n      Create Reply\\n    </ion-button>\\n\\n  </form>\\n\\n</ion-content>\\n\"","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { ReplyModalPage } from './reply-modal.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ReplyModalPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class ReplyModalPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { File } from '@ionic-native/file/ngx';\nimport { Camera } from '@ionic-native/camera/ngx';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { ReplyModalPageRoutingModule } from './reply-modal-routing.module';\n\nimport { ReplyModalPage } from './reply-modal.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    ReplyModalPageRoutingModule,\n    ReactiveFormsModule\n  ],\n  providers: [\n    Camera,\n    File\n  ],\n  declarations: [ReplyModalPage]\n})\nexport class ReplyModalPageModule {}\n","module.exports = \"#title {\\n  font-size: 20px;\\n  color: black;\\n  margin-left: 10px;\\n  font-weight: bold;\\n}\\n\\n#text {\\n  font-size: 16px;\\n  color: #444444;\\n  margin-left: 10px;\\n}\\n\\n#timestamp {\\n  font-size: 12px;\\n  margin-left: 10px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2pidWt1dHMvRG9jdW1lbnRzL0dpdGh1Yi9Bbm9uU29jaWFsTWVkaWEvc3JjL2FwcC9yZXBseS1tb2RhbC9yZXBseS1tb2RhbC5wYWdlLnNjc3MiLCJzcmMvYXBwL3JlcGx5LW1vZGFsL3JlcGx5LW1vZGFsLnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLGVBQUE7RUFDQSxZQUFBO0VBQ0EsaUJBQUE7RUFDQSxpQkFBQTtBQ0NKOztBREVBO0VBQ0ksZUFBQTtFQUNBLGNBQUE7RUFDQSxpQkFBQTtBQ0NKOztBREVBO0VBQ0ksZUFBQTtFQUNBLGlCQUFBO0FDQ0oiLCJmaWxlIjoic3JjL2FwcC9yZXBseS1tb2RhbC9yZXBseS1tb2RhbC5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIjdGl0bGUge1xuICAgIGZvbnQtc2l6ZTogMjBweDtcbiAgICBjb2xvcjogYmxhY2s7XG4gICAgbWFyZ2luLWxlZnQ6IDEwcHg7XG4gICAgZm9udC13ZWlnaHQ6IGJvbGQ7XG59XG5cbiN0ZXh0IHtcbiAgICBmb250LXNpemU6IDE2cHg7XG4gICAgY29sb3I6ICM0NDQ0NDQ7XG4gICAgbWFyZ2luLWxlZnQ6IDEwcHg7XG59XG5cbiN0aW1lc3RhbXAge1xuICAgIGZvbnQtc2l6ZTogMTJweDtcbiAgICBtYXJnaW4tbGVmdDogMTBweDtcbn0iLCIjdGl0bGUge1xuICBmb250LXNpemU6IDIwcHg7XG4gIGNvbG9yOiBibGFjaztcbiAgbWFyZ2luLWxlZnQ6IDEwcHg7XG4gIGZvbnQtd2VpZ2h0OiBib2xkO1xufVxuXG4jdGV4dCB7XG4gIGZvbnQtc2l6ZTogMTZweDtcbiAgY29sb3I6ICM0NDQ0NDQ7XG4gIG1hcmdpbi1sZWZ0OiAxMHB4O1xufVxuXG4jdGltZXN0YW1wIHtcbiAgZm9udC1zaXplOiAxMnB4O1xuICBtYXJnaW4tbGVmdDogMTBweDtcbn0iXX0= */\"","import { Component, OnInit, Input } from '@angular/core';\nimport { NavParams } from '@ionic/angular';\nimport { ModalController } from '@ionic/angular';\nimport { Validators, FormBuilder, FormControl, FormGroup } from '@angular/forms';\nimport { ItemService } from '../item.service';\nimport * as firebase from 'firebase';\nimport { Events } from '@ionic/angular';\nimport { Camera, CameraOptions } from '@ionic-native/camera/ngx';\nimport { File } from '@ionic-native/file/ngx';\nimport { v1 as uuidv1 } from 'uuid';\nimport { ActionSheetController } from '@ionic/angular';\n\n\n@Component({\n  selector: 'app-reply-modal',\n  templateUrl: './reply-modal.page.html',\n  styleUrls: ['./reply-modal.page.scss'],\n})\nexport class ReplyModalPage implements OnInit {\n\n  private modalCtrl;\n  new_reply_form: FormGroup;\n\n  imgFile;\n  @Input() post : any;\n  @Input() board : String;\n  @Input() originalPost : string;\n\n  constructor(\n    public modalController: ModalController,\n    navParams: NavParams,\n    public formBuilder: FormBuilder,\n    public itemService: ItemService,\n    public events: Events,\n    private camera: Camera,\n    public actionSheet : ActionSheetController,\n    private file : File,\n  ) \n  { \n    this.modalCtrl = modalController;\n  }\n\n  ngOnInit() {\n    this.new_reply_form = this.formBuilder.group({\n      text: new FormControl('',Validators.required)\n    });\n  }\n\n  private getDate(d) {\n    var date = new Date(parseInt(d));\n    return (date.getMonth()+1)+ \"/\" + date.getDate() + \"/\" +date.getFullYear() +\" \"+date.getHours()+\":\"+(\"0\"+date.getMinutes()).slice(-2)+\":\"+(\"0\"+date.getSeconds()).slice(-2);\n  }\n\n  // pops up the action sheet\n  async selectImage() {\n    const actionSheet = await this.actionSheet.create({\n      header : \"Select Image Source\",\n      buttons: [{\n        text : 'Load From Library',\n        handler: () => {\n          this.pickImage(this.camera.PictureSourceType.PHOTOLIBRARY);\n        }\n      },\n      {\n        text : 'Use Camera',\n        handler : () => {\n          this.pickImage(this.camera.PictureSourceType.CAMERA);\n        }\n      },\n      {\n        text : 'Cancel',\n        role : 'cancel'\n      }\n    ]\n    });\n    await actionSheet.present();\n  }\n\n  pickImage(sourceType) {\n    const options: CameraOptions = {\n      quality: 100,\n      sourceType: sourceType,\n      destinationType: this.camera.DestinationType.FILE_URI,\n      encodingType: this.camera.EncodingType.JPEG,\n      mediaType: this.camera.MediaType.PICTURE\n    }\n\n    this.camera.getPicture(options).then((imageData) => {\n      // imageData is either a base64 encoded string or a file URI\n      // If it's base64 (DATA_URL):\n      let base64Image = 'data:image/jpeg;base64,' + imageData;\n      this.imgFile = base64Image;\n    }, (err) => {\n      console.log(err);\n    });\n\n  }\n\n  // called when the button is clicked\n  private async createReply(reply) {\n    console.log(reply);\n    // this will present a toast\n    await this.itemService.presentToast(\"Reply Created!\");\n\n    var self = this;\n    let object = {\n      text : reply.text,\n      replyTo : this.post.docId,\n      timestamp : Date.now()\n    };\n\n    // check if we need to upload an image\n    if (this.imgFile != null) {\n      // upload the actual image to firebase \n      const pictures = firebase.storage().ref('pictures/'+uuidv1());\n      let uploadTask = await pictures.putString(this.imgFile,'data_url');\n\n      await pictures.getDownloadURL().then(function(downloadURL) {\n        console.log('FILE AVAILABLE AT ',downloadURL);\n        object['img'] =  downloadURL;\n      }); \n    }\n\n\n    // add to db\n    var db = firebase.firestore();\n    db.collection(this.board+'/'+this.originalPost+'/replies').add(object)\n    .then(function(docRef) {\n      console.log(\"Document written with ID\",docRef.id);\n      // TODO: add replies to your post!\n    })\n    .catch(function(error){\n      console.error(\"Error adding document: \",error);\n    });\n\n    // clear the form and dismiss the modal\n    await this.dismiss();\n    this.new_reply_form.reset();\n    this.events.publish('replychange',Date.now());\n  }\n\n  dismiss() {\n    // using the injected ModalController this page\n    // can \"dismiss\" itself and optionally pass back data\n    this.modalCtrl.dismiss({\n      'dismissed': true\n    });\n  }\n\n}\n"],"sourceRoot":""}